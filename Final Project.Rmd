---
title: "The Bechdel Test Data Analysis"
author: "Claire Burcik and Hannah Park"
output: 
  html_document: default
  pdf_document: default
date: "`r paste('Last Updated:', Sys.Date())`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### The Bechdel Test Dataset

Over the last few decades, fans and critics alike have increasignly called out gender bias in the film industry. More specifically, many have recognized a lack of depth, low numbers of leads, and sterotypical roles for female characters. One way to measure this bias, first coined by cartoonist Alison Bechdel in 1985, is the Bechdel Test. If a movie passes the Bechdel test, it is said that the movie gave the female charcters a bare minimum level of depth. The test has three criteria that a movie must meet in order to pass. The three criteria are:
1. There are at least two named women
2. They Have a conversation with each other at some point
3. That conversation isn't about a male character

This test is not by any means an offical metric. Like Bechdel's original intention, it is mostly used to poke fun at the lack of female character development in Hollywood. So, when we saw a dataset that evaluated movies based on this test, we thought that it would be a fun data set to analyze.

The data set was sourced from FiveThirtyEight and it combined data from two previous data sets (BechdelTest.com for the Bechdel Test results and Numbers.com for the financial information). The data consists of 1615 realeased from 1990-2013. The attributes in this dataset are release year, Imdb code, Title, Test (states"ok" if movie passed, otherwise states the crteria that made the movie fail. The creators of the dataset also state whether they disagree with the result of the test), Clean test (same as Test but without the creators stating if they disagree), Binary (PASS or FAIL), Domestic Gross, International Gross, Code (year/PASS or FAIL), Budget, Domestic gross (as of 2013), International gross (as of 2013), Period code, and Decade code.

The research questions we wanted to explore with this data set include:
-Does budget play a role in whether a movie passes or fails the Bechdel Test?
-Does the year the movie was released contribute to if a movie passes or fails the Bechdel Test?
-Of the movies that fail the Bechdel Test, how many fail each criteria?
-How does the domestic and international gross compare to the pass rate of the Bechdel test and the movieâ€™s budget?

### Data Exploration

```{r}
#ADD CODING STYLE
#reading in the data
bechdel_raw <- read.csv("movies.csv")
View(bechdel_raw)

#loading necessary packages
library(dplyr)
library(ggplot2)
library(kableExtra)
library(janitor)
```

```{r}
wrangled_budget<-bechdel_raw %>%
  group_by(clean_test)%>%
  select(clean_test, binary, budget)

#basic pass/fail plot
ggplot(data=wrangled_budget,
  mapping=aes(x = budget, y = binary)) + #binary=pass/fail test results
  #made boxplots have horizontal orientation-->more appealing to the eye
  labs(x="Budget ($)",
       y="Test Result",
       title="Distribution of Budget for Movies that Pass vs Fail")+ #tidying up labels
  geom_boxplot(fill = "#112446") +
  theme_minimal()

#more detailed
ggplot(data=wrangled_budget, 
  mapping=aes(x = budget, y = clean_test))+
  #swapped out y axis value "binary" for "clean_test"
  #gives distribution of budget across categories (pass or fail(which criteria it failed))
  labs(x="Budget ($)",
       y="Test Result",
       title="Distribution of Budget for Movies that Pass vs Fail (Detailed)")+  #tidying up labels
  geom_boxplot(fill = "#EF562D")+ #changing color to orange
  theme_minimal() 
```

```{r}
frequency_data <- bechdel_raw %>%
  group_by(clean_test)%>%
  #reduce to just failure cases
  filter(binary=="FAIL")%>%
  select(clean_test, decade.code)

failure_table <-frequency_data %>%
   #makes the decade.code correspond to rows and clean_test correspond to columns
   tabyl(decade.code, clean_test)%>%
   adorn_totals(where = c("row", "col") ) %>%
   adorn_percentages(denominator = "all") %>%
   adorn_pct_formatting(digits = 2) %>% 
   #Change labels
   adorn_title(
     placement = "combined",
     row_name = "Decade",
     col_name = "Test Results") 
 
#add absolute frequencies
formatNs <- attr(failure_table, "core") %>%  
  adorn_totals(where = c("row", "col")) %>%
  mutate(
     across(.cols = where(is.numeric), .fns = ~format(.x, big.mark = ","))
   )
 
failure_freq_tab <- failure_table %>%
  adorn_ns(position= "front", ns = formatNs)

failure_freq_tab %>%
   kable(
     caption = "Number of Failures per Decade, per Criteria", #add title
     booktabs = TRUE,
     align = c("l", rep("c", 6))
   )%>%
   kableExtra::kable_styling(
       bootstrap_options = c("striped"),
       font_size = 16
     )
```
